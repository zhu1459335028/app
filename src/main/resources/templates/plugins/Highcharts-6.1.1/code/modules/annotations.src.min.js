"use strict";(function(a){if(typeof module==="object"&&module.exports){module.exports=a}else{a(Highcharts)}}(function(a){(function(n){var g=n.merge,u=n.addEvent,y=n.extend,e=n.each,p=n.isString,q=n.isNumber,c=n.defined,l=n.isObject,w=n.inArray,B=n.erase,s=n.find,v=n.format,f=n.pick,r=n.objectEach,j=n.uniqueKey,C=n.doc,z=n.splat,h=n.destroyObjectProperties,k=n.grep,m=n.Tooltip.prototype,x=n.Series.prototype,i=n.Chart.prototype;var o={arrow:{tagName:"marker",render:false,id:"arrow",refY:5,refX:5,markerWidth:10,markerHeight:10,children:[{tagName:"path",d:"M 0 0 L 10 5 L 0 10 Z",strokeWidth:0}]}};var A={markerSetter:function(D){return function(E){this.attr(D,"url(#"+E+")")}}};y(A,{markerEndSetter:A.markerSetter("marker-end"),markerStartSetter:A.markerSetter("marker-start")});n.SVGRenderer.prototype.definition=function(E){var F=this;function D(H,I){var G;e(z(H),function(L){var K=F.createElement(L.tagName),J={};r(L,function(N,M){if(M!=="tagName"&&M!=="children"&&M!=="textContent"){J[M]=N}});K.attr(J);K.add(I||F.defs);if(L.textContent){K.element.appendChild(C.createTextNode(L.textContent))}D(L.children||[],K);G=K});return G}return D(E)};n.SVGRenderer.prototype.addMarker=function(H,G){var F={id:H};var E={stroke:G.color||"none",fill:G.color||"rgba(0, 0, 0, 0.75)"};F.children=n.map(G.children,function(I){return g(E,I)});var D=this.definition(g({markerWidth:20,markerHeight:20,refX:0,refY:0,orient:"auto"},G,F));D.id=H;return D};var d=n.MockPoint=function(E,D){this.mock=true;this.series={visible:true,chart:E,getPlotBox:x.getPlotBox};this.init(E,D)};var b=n.mockPoint=function(D,E){return new d(D,E)};d.prototype={init:function(H,G){var D=G.xAxis,I=c(D)?H.xAxis[D]||H.get(D):null,F=G.yAxis,E=c(F)?H.yAxis[F]||H.get(F):null;if(I){this.x=G.x;this.series.xAxis=I}else{this.plotX=G.x}if(E){this.y=G.y;this.series.yAxis=E}else{this.plotY=G.y}},translate:function(){var E=this.series,F=E.xAxis,D=E.yAxis;if(F){this.plotX=F.toPixels(this.x,true)}if(D){this.plotY=D.toPixels(this.y,true)}this.isInside=this.isInsidePane()},alignToBox:function(F){if(F){this.translate()}var D=this.plotX,G=this.plotY,E;if(this.series.chart.inverted){E=D;D=G;G=E}return[D,G,0,0]},getLabelConfig:function(){return{x:this.x,y:this.y,point:this}},isInsidePane:function(){var F=this.plotX,E=this.plotY,G=this.series.xAxis,D=this.series.yAxis,H=true;if(G){H=c(F)&&F>=0&&F<=G.len}if(D){H=H&&c(E)&&E>=0&&E<=D.len}return H}};n.defaultOptions.annotations=[];var t=n.Annotation=function(D,E){this.chart=D;this.labels=[];this.shapes=[];this.userOptions=E;this.options=g(this.defaultOptions,E);this.init(D,E)};t.prototype={shapesWithoutBackground:["connector"],attrsMap:{backgroundColor:"fill",borderColor:"stroke",borderWidth:"stroke-width",dashStyle:"dashstyle",strokeWidth:"stroke-width",stroke:"stroke",fill:"fill",zIndex:"zIndex",width:"width",height:"height",borderRadius:"r",r:"r",padding:"padding"},defaultOptions:{visible:true,labelOptions:{align:"center",allowOverlap:false,backgroundColor:"rgba(0, 0, 0, 0.75)",borderColor:"black",borderRadius:3,borderWidth:1,className:"",crop:false,formatter:function(){return c(this.y)?this.y:"Annotation label"},overflow:"justify",padding:5,shadow:false,shape:"callout",style:{fontSize:"11px",fontWeight:"normal",color:"contrast"},useHTML:false,verticalAlign:"bottom",x:0,y:-16},shapeOptions:{stroke:"rgba(0, 0, 0, 0.75)",strokeWidth:1,fill:"rgba(0, 0, 0, 0.75)",r:0},zIndex:6},init:function(){var D=this;e(this.options.labels||[],this.initLabel,this);e(this.options.shapes||[],this.initShape,this);this.labelCollector=function(){return k(D.labels,function(E){return !E.options.allowOverlap})};this.chart.labelCollectors.push(this.labelCollector)},redraw:function(){if(!this.group){this.render()}this.redrawItems(this.shapes);this.redrawItems(this.labels)},redrawItems:function(D){var E=D.length;while(E--){this.redrawItem(D[E])}},render:function(){var D=this.chart.renderer;var E=this.group=D.g("annotation").attr({zIndex:this.options.zIndex,visibility:this.options.visible?"visible":"hidden"}).add();this.shapesGroup=D.g("annotation-shapes").add(E);this.labelsGroup=D.g("annotation-labels").attr({translateX:0,translateY:0}).add(E);this.shapesGroup.clip(this.chart.plotBoxClip)},setVisible:function(D){var E=this.options,F=f(D,!E.visible);this.group.attr({visibility:F?"visible":"hidden"});E.visible=F},destroy:function(){var E=this.chart,D=function(F){F.destroy()};B(this.chart.labelCollectors,this.labelCollector);e(this.labels,D);e(this.shapes,D);h(this,E)},initShape:function(G){var I=this.chart.renderer,F=g(this.options.shapeOptions,G),D=this.attrsFromOptions(F),H=I[F.type]?F.type:"rect",E=I[H](0,-9000000000,0,0);E.points=[];E.type=H;E.options=F;E.itemType="shape";if(H==="path"){y(E,{markerStartSetter:A.markerStartSetter,markerEndSetter:A.markerEndSetter,markerStart:A.markerStart,markerEnd:A.markerEnd})}E.attr(D);if(F.className){E.addClass(F.className)}this.shapes.push(E)},initLabel:function(E){var G=g(this.options.labelOptions,E),D=this.attrsFromOptions(G),F=this.chart.renderer.label("",0,-9000000000,G.shape,null,null,G.useHTML,null,"annotation-label");F.points=[];F.options=G;F.itemType="label";F.labelrank=G.labelrank;F.annotation=this;F.attr(D);var H=G.style;if(H.color==="contrast"){H.color=this.chart.renderer.getContrast(w(G.shape,this.shapesWithoutBackground)>-1?"#FFFFFF":G.backgroundColor)}F.css(H).shadow(G.shadow);if(G.className){F.addClass(G.className)}this.labels.push(F)},redrawItem:function(F){var E=this.linkPoints(F),D=F.options,H,G=this.chart.time;if(!E.length){this.destroyItem(F)}else{if(!F.parentGroup){this.renderItem(F)}if(F.itemType==="label"){H=D.format||D.text;F.attr({text:H?v(H,E[0].getLabelConfig(),G):D.formatter.call(E[0])})}if(F.type==="path"){this.redrawPath(F)}else{this.alignItem(F,!F.placed)}}},destroyItem:function(D){B(this[D.itemType+"s"],D);D.destroy()},pointItem:function(E,D){if(!D||D.series===null){if(l(E)){D=b(this.chart,E)}else{if(p(E)){D=this.chart.get(E)||null}}}return D},linkPoints:function(H){var I=(H.options.points||(H.options.point&&n.splat(H.options.point))),G=H.points,E=I&&I.length,F,D;for(F=0;F<E;F++){D=this.pointItem(I[F],G[F]);if(!D){return(H.points=[])}G[F]=D}return G},alignItem:function(G,D){var F=this.itemAnchor(G,G.points[0]),E=this.itemPosition(G,F);if(E){G.alignAttr=E;G.placed=true;E.anchorX=F.absolutePosition.x;E.anchorY=F.absolutePosition.y;G[D?"attr":"animate"](E)}else{G.placed=false;G.attr({x:0,y:-9000000000})}},redrawPath:function(E,G){var O=E.points,L=E["stroke-width"]||1,J=["M"],M=0,D=0,H=O&&O.length,I,F,N,K;if(H){do{N=O[M];F=this.itemAnchor(E,N).absolutePosition;J[++D]=F.x;J[++D]=F.y;I=D%5;if(I===0){if(J[I+1]===J[I+4]){J[I+1]=J[I+4]=Math.round(J[I+1])-(L%2/2)}if(J[I+2]===J[I+5]){J[I+2]=J[I+5]=Math.round(J[I+2])+(L%2/2)}}if(M<H-1){J[++D]="L"}K=N.series.visible}while(++M<H&&K)}if(K){E[G?"attr":"animate"]({d:J})}else{E.attr({d:"M 0 "+-9000000000})}E.placed=K},renderItem:function(D){D.add(D.itemType==="label"?this.labelsGroup:this.shapesGroup);this.setItemMarkers(D)},setItemMarkers:function(I){var H=I.options,G=this.chart,D=G.options.defs,J=H.fill,F=c(J)&&J!=="none"?J:H.stroke,E=function(K){var O=H[K],P,M,N,L;if(O){for(N in D){P=D[N];if(O===P.id&&P.tagName==="marker"){M=P;break}}if(M){L=I[K]=G.renderer.addMarker((H.id||j())+"-"+M.id,g(M,{color:F}));I.attr(K,L.attr("id"))}}};e(["markerStart","markerEnd"],E)},itemAnchor:function(H,D){var E=D.series.getPlotBox(),G=D.mock?D.alignToBox(true):m.getAnchor.call({chart:this.chart},D),F={x:G[0],y:G[1],height:G[2]||0,width:G[3]||0};return{relativePosition:F,absolutePosition:g(F,{x:F.x+E.translateX,y:F.y+E.translateY})}},itemPosition:function(N,E){var J=this.chart,M=N.points[0],O=N.options,F=E.absolutePosition,G=E.relativePosition,D,H,L,I,K=M.series.visible&&d.prototype.isInsidePane.call(M);if(K){if(c(O.distance)||O.positioner){D=(O.positioner||m.getPosition).call({chart:J,distance:f(O.distance,16)},N.width,N.height,{plotX:G.x,plotY:G.y,negative:M.negative,ttBelow:M.ttBelow,h:G.height||G.width})}else{H={x:F.x,y:F.y,width:0,height:0};D=this.alignedPosition(y(O,{width:N.width,height:N.height}),H);if(N.options.overflow==="justify"){D=this.alignedPosition(this.justifiedOptions(N,O,D),H)}}if(O.crop){L=D.x-J.plotLeft;I=D.y-J.plotTop;K=J.isInsidePlot(L,I)&&J.isInsidePlot(L+N.width,I+N.height)}}return K?D:null},alignedPosition:function(G,F){var K=G.align,J=G.verticalAlign,D=(F.x||0)+(G.x||0),I=(F.y||0)+(G.y||0),H,E;if(K==="right"){H=1}else{if(K==="center"){H=2}}if(H){D+=(F.width-(G.width||0))/H}if(J==="bottom"){E=1}else{if(J==="middle"){E=2}}if(E){I+=(F.height-(G.height||0))/E}return{x:Math.round(D),y:Math.round(I)}},justifiedOptions:function(M,D,G){var I=this.chart,H=D.align,F=D.verticalAlign,L=M.box?0:(M.padding||0),N=M.getBBox(),E,O={align:H,verticalAlign:F,x:D.x,y:D.y,width:M.width,height:M.height},K=G.x-I.plotLeft,J=G.y-I.plotTop;E=K+L;if(E<0){if(H==="right"){O.align="left"}else{O.x=-E}}E=K+N.width-L;if(E>I.plotWidth){if(H==="left"){O.align="right"}else{O.x=I.plotWidth-E}}E=J+L;if(E<0){if(F==="bottom"){O.verticalAlign="top"}else{O.y=-E}}E=J+N.height-L;if(E>I.plotHeight){if(F==="top"){O.verticalAlign="bottom"}else{O.y=I.plotHeight-E}}return O},attrsFromOptions:function(E){var H=this.attrsMap,D={},F,G;for(F in E){G=H[F];if(G){D[G]=E[F]}}return D}};n.extend(i,{addAnnotation:function(E,F){var D=new t(this,E);this.annotations.push(D);this.options.annotations.push(E);if(f(F,true)){D.redraw()}return D},removeAnnotation:function(F){var E=this.annotations,D=s(E,function(G){return G.options.id===F});if(D){B(this.options.annotations,D.userOptions);B(E,D);D.destroy()}},drawAnnotations:function(){var E=this.plotBoxClip,D=this.plotBox;if(E){E.attr(D)}else{this.plotBoxClip=this.renderer.clipRect(D)}e(this.annotations,function(F){F.redraw()})}});i.callbacks.push(function(D){D.annotations=[];e(D.options.annotations,function(E){D.annotations.push(new t(D,E))});D.drawAnnotations();u(D,"redraw",D.drawAnnotations);u(D,"destroy",function(){var E=D.plotBoxClip;if(E&&E.destroy){E.destroy()}})});u(n.Chart,"afterGetContainer",function(){this.options.defs=g(o,this.options.defs||{});r(this.options.defs,function(D){if(D.tagName==="marker"&&D.render!==false){this.renderer.addMarker(D.id,D)}},this)});n.SVGRenderer.prototype.symbols.connector=function(J,I,K,H,M){var F=M&&M.anchorX,E=M&&M.anchorY,L,G,D=K/2;if(q(F)&&q(E)){L=["M",F,E];G=I-E;if(G<0){G=-H-G}if(G<K){D=F<J+(K/2)?G:K-G}if(E>I+H){L.push("L",J+D,I+H)}else{if(E<I){L.push("L",J+D,I)}else{if(F<J){L.push("L",J,I+H/2)}else{if(F>J+K){L.push("L",J+K,I+H/2)}}}}}return L||[]}}(a));return(function(){}())}));