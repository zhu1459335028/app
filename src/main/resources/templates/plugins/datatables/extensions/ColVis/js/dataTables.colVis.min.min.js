/*!
 ColVis 1.1.2
 Â©2010-2015 SpryMedia Ltd - datatables.net/license
*/
(function(b,c,a){b=function(g){var f=function(e,d){(!this.CLASS||"ColVis"!=this.CLASS)&&alert("Warning: ColVis must be initialised with the keyword 'new'");"undefined"==typeof d&&(d={});var h=g.fn.dataTable.camelToHungarian;h&&(h(f.defaults,f.defaults,!0),h(f.defaults,d));this.s={dt:null,oInit:d,hidden:!0,abOriginal:[]};this.dom={wrapper:null,button:null,collection:null,background:null,catcher:null,buttons:[],groupButtons:[],restore:null};f.aInstances.push(this);this.s.dt=g.fn.dataTable.Api?(new g.fn.dataTable.Api(e)).settings()[0]:e;this._fnConstruct(d);return this};f.prototype={button:function(){return this.dom.wrapper},fnRebuild:function(){this.rebuild()},rebuild:function(){for(var d=this.dom.buttons.length-1;0<=d;d--){this.dom.collection.removeChild(this.dom.buttons[d])}this.dom.buttons.splice(0,this.dom.buttons.length);this.dom.groupButtons.splice(0,this.dom.groupButtons.length);this.dom.restore&&this.dom.restore.parentNode(this.dom.restore);this._fnAddGroups();this._fnAddButtons();this._fnDrawCallback()},_fnConstruct:function(e){this._fnApplyCustomisation(e);var d=this,i,h;this.dom.wrapper=c.createElement("div");this.dom.wrapper.className="ColVis";this.dom.button=g("<button />",{"class":!this.s.dt.bJUI?"ColVis_Button ColVis_MasterButton":"ColVis_Button ColVis_MasterButton ui-button ui-state-default"}).append("<span>"+this.s.buttonText+"</span>").bind("mouseover"==this.s.activate?"mouseover":"click",function(j){j.preventDefault();d._fnCollectionShow()}).appendTo(this.dom.wrapper)[0];this.dom.catcher=this._fnDomCatcher();this.dom.collection=this._fnDomCollection();this.dom.background=this._fnDomBackground();this._fnAddGroups();this._fnAddButtons();i=0;for(h=this.s.dt.aoColumns.length;i<h;i++){this.s.abOriginal.push(this.s.dt.aoColumns[i].bVisible)}this.s.dt.aoDrawCallback.push({fn:function(){d._fnDrawCallback.call(d)},sName:"ColVis"});g(this.s.dt.oInstance).bind("column-reorder.dt",function(j,l,k){i=0;for(h=d.s.aiExclude.length;i<h;i++){d.s.aiExclude[i]=k.aiInvertMapping[d.s.aiExclude[i]]}j=d.s.abOriginal.splice(k.iFrom,1)[0];d.s.abOriginal.splice(k.iTo,0,j);d.fnRebuild()});g(this.s.dt.oInstance).bind("destroy.dt",function(){g(d.dom.wrapper).remove()});this._fnDrawCallback()},_fnApplyCustomisation:function(e){g.extend(!0,this.s,f.defaults,e);!this.s.showAll&&this.s.bShowAll&&(this.s.showAll=this.s.sShowAll);!this.s.restore&&this.s.bRestore&&(this.s.restore=this.s.sRestore);var e=this.s.groups,d=this.s.aoGroups;if(e){for(var i=0,h=e.length;i<h;i++){if(e[i].title&&(d[i].sTitle=e[i].title),e[i].columns){d[i].aiColumns=e[i].columns}}}},_fnDrawCallback:function(){for(var i=this.s.dt.aoColumns,d=this.dom.buttons,n=this.s.aoGroups,l,k=0,j=d.length;k<j;k++){l=d[k],l.__columnIdx!==a&&g("input",l).prop("checked",i[l.__columnIdx].bVisible)}d=0;for(l=n.length;d<l;d++){i:{for(var k=n[d].aiColumns,j=0,m=k.length;j<m;j++){if(!1===i[k[j]].bVisible){k=!1;break i}}k=!0}if(k){g("input",this.dom.groupButtons[d]).prop("checked",!0),g("input",this.dom.groupButtons[d]).prop("indeterminate",!1)}else{i:{k=n[d].aiColumns;j=0;for(m=k.length;j<m;j++){if(!0===i[k[j]].bVisible){k=!1;break i}}k=!0}k?(g("input",this.dom.groupButtons[d]).prop("checked",!1),g("input",this.dom.groupButtons[d]).prop("indeterminate",!1)):g("input",this.dom.groupButtons[d]).prop("indeterminate",!0)}}},_fnAddGroups:function(){var e;if("undefined"!=typeof this.s.aoGroups){for(var d=0,h=this.s.aoGroups.length;d<h;d++){e=this._fnDomGroupButton(d),this.dom.groupButtons.push(e),this.dom.buttons.push(e),this.dom.collection.appendChild(e)}}},_fnAddButtons:function(){var e,d=this.s.dt.aoColumns;if(-1===g.inArray("all",this.s.aiExclude)){for(var i=0,h=d.length;i<h;i++){-1===g.inArray(i,this.s.aiExclude)&&(e=this._fnDomColumnButton(i),e.__columnIdx=i,this.dom.buttons.push(e))}}"alpha"===this.s.order&&this.dom.buttons.sort(function(j,m){var l=d[j.__columnIdx].sTitle,k=d[m.__columnIdx].sTitle;return l===k?0:l<k?-1:1});this.s.restore&&(e=this._fnDomRestoreButton(),e.className+=" ColVis_Restore",this.dom.buttons.push(e));this.s.showAll&&(e=this._fnDomShowXButton(this.s.showAll,!0),e.className+=" ColVis_ShowAll",this.dom.buttons.push(e));this.s.showNone&&(e=this._fnDomShowXButton(this.s.showNone,!1),e.className+=" ColVis_ShowNone",this.dom.buttons.push(e));g(this.dom.collection).append(this.dom.buttons)},_fnDomRestoreButton:function(){var d=this;return g('<li class="ColVis_Special '+(this.s.dt.bJUI?"ui-button ui-state-default":"")+'">'+this.s.restore+"</li>").click(function(){for(var e=0,h=d.s.abOriginal.length;e<h;e++){d.s.dt.oInstance.fnSetColumnVis(e,d.s.abOriginal[e],!1)}d._fnAdjustOpenRows();d.s.dt.oInstance.fnAdjustColumnSizing(!1);d.s.dt.oInstance.fnDraw(!1)})[0]},_fnDomShowXButton:function(e,d){var h=this;return g('<li class="ColVis_Special '+(this.s.dt.bJUI?"ui-button ui-state-default":"")+'">'+e+"</li>").click(function(){for(var i=0,j=h.s.abOriginal.length;i<j;i++){-1===h.s.aiExclude.indexOf(i)&&h.s.dt.oInstance.fnSetColumnVis(i,d,!1)}h._fnAdjustOpenRows();h.s.dt.oInstance.fnAdjustColumnSizing(!1);h.s.dt.oInstance.fnDraw(!1)})[0]},_fnDomGroupButton:function(e){var d=this,h=this.s.aoGroups[e];return g('<li class="ColVis_Special '+(this.s.dt.bJUI?"ui-button ui-state-default":"")+'"><label><input type="checkbox" /><span>'+h.sTitle+"</span></label></li>").click(function(i){var j=!g("input",this).is(":checked");"li"!==i.target.nodeName.toLowerCase()&&(j=!j);for(i=0;i<h.aiColumns.length;i++){d.s.dt.oInstance.fnSetColumnVis(h.aiColumns[i],j)}})[0]},_fnDomColumnButton:function(e){var d=this,i=this.s.dt.aoColumns[e],h=this.s.dt,i=null===this.s.fnLabel?i.sTitle:this.s.fnLabel(e,i.sTitle,i.nTh);return g("<li "+(h.bJUI?'class="ui-button ui-state-default"':"")+'><label><input type="checkbox" /><span>'+i+"</span></label></li>").click(function(l){var k=!g("input",this).is(":checked");if("li"!==l.target.nodeName.toLowerCase()&&("input"==l.target.nodeName.toLowerCase()||null===d.s.fnStateChange)){k=!k}var j=g.fn.dataTableExt.iApiIndex;g.fn.dataTableExt.iApiIndex=d._fnDataTablesApiIndex.call(d);h.oFeatures.bServerSide?(d.s.dt.oInstance.fnSetColumnVis(e,k,!1),d.s.dt.oInstance.fnAdjustColumnSizing(!1),(""!==h.oScroll.sX||""!==h.oScroll.sY)&&d.s.dt.oInstance.oApi._fnScrollDraw(d.s.dt),d._fnDrawCallback()):d.s.dt.oInstance.fnSetColumnVis(e,k);g.fn.dataTableExt.iApiIndex=j;null!==d.s.fnStateChange&&("span"==l.target.nodeName.toLowerCase()&&l.preventDefault(),d.s.fnStateChange.call(d,e,k))})[0]},_fnDataTablesApiIndex:function(){for(var e=0,d=this.s.dt.oInstance.length;e<d;e++){if(this.s.dt.oInstance[e]==this.s.dt.nTable){return e}}return 0},_fnDomCollection:function(){return g("<ul />",{"class":!this.s.dt.bJUI?"ColVis_collection":"ColVis_collection ui-buttonset ui-buttonset-multi"}).css({display:"none",opacity:0,position:!this.s.bCssPosition?"absolute":""})[0]},_fnDomCatcher:function(){var e=this,d=c.createElement("div");d.className="ColVis_catcher";g(d).click(function(){e._fnCollectionHide.call(e,null,null)});return d},_fnDomBackground:function(){var e=this,d=g("<div></div>").addClass("ColVis_collectionBackground").css("opacity",0).click(function(){e._fnCollectionHide.call(e,null,null)});"mouseover"==this.s.activate&&d.mouseover(function(){e.s.overcollection=!1;e._fnCollectionHide.call(e,null,null)});return d[0]},_fnCollectionShow:function(){var i=this,d;d=g(this.dom.button).offset();var m=this.dom.collection,k=this.dom.background,l=parseInt(d.left,10),j=parseInt(d.top+g(this.dom.button).outerHeight(),10);this.s.bCssPosition||(m.style.top=j+"px",m.style.left=l+"px");g(m).css({display:"block",opacity:0});k.style.bottom="0px";k.style.right="0px";j=this.dom.catcher.style;j.height=g(this.dom.button).outerHeight()+"px";j.width=g(this.dom.button).outerWidth()+"px";j.top=d.top+"px";j.left=l+"px";c.body.appendChild(k);c.body.appendChild(m);c.body.appendChild(this.dom.catcher);g(m).animate({opacity:1},i.s.iOverlayFade);g(k).animate({opacity:0.1},i.s.iOverlayFade,"linear",function(){g.browser&&(g.browser.msie&&g.browser.version=="6.0")&&i._fnDrawCallback()});this.s.bCssPosition||(d="left"==this.s.sAlign?l:l-g(m).outerWidth()+g(this.dom.button).outerWidth(),m.style.left=d+"px",k=g(m).outerWidth(),g(m).outerHeight(),l=g(c).width(),d+k>l&&(m.style.left=l-k+"px"));this.s.hidden=!1},_fnCollectionHide:function(){var d=this;!this.s.hidden&&null!==this.dom.collection&&(this.s.hidden=!0,g(this.dom.collection).animate({opacity:0},d.s.iOverlayFade,function(){this.style.display="none"}),g(this.dom.background).animate({opacity:0},d.s.iOverlayFade,function(){c.body.removeChild(d.dom.background);c.body.removeChild(d.dom.catcher)}))},_fnAdjustOpenRows:function(){for(var h=this.s.dt.aoOpenRows,e=this.s.dt.oApi._fnVisbleColumns(this.s.dt),j=0,i=h.length;j<i;j++){h[j].nTr.getElementsByTagName("td")[0].colSpan=e}}};f.fnRebuild=function(e){var d=null;"undefined"!=typeof e&&(d=g.fn.dataTable.Api?(new g.fn.dataTable.Api(e)).table().node():e.fnSettings().nTable);for(var i=0,h=f.aInstances.length;i<h;i++){("undefined"==typeof e||d==f.aInstances[i].s.dt.nTable)&&f.aInstances[i].fnRebuild()}};f.defaults={active:"click",buttonText:"Show / hide columns",aiExclude:[],bRestore:!1,sRestore:"Restore original",bShowAll:!1,sShowAll:"Show All",sAlign:"left",fnStateChange:null,iOverlayFade:500,fnLabel:null,bCssPosition:!1,aoGroups:[],order:"column"};f.aInstances=[];f.prototype.CLASS="ColVis";f.VERSION="1.1.2";f.prototype.VERSION=f.VERSION;"function"==typeof g.fn.dataTable&&"function"==typeof g.fn.dataTableExt.fnVersionCheck&&g.fn.dataTableExt.fnVersionCheck("1.7.0")?g.fn.dataTableExt.aoFeatures.push({fnInit:function(e){var d=e.oInit;return(new f(e,d.colVis||d.oColVis||{})).button()},cFeature:"C",sFeature:"ColVis"}):alert("Warning: ColVis requires DataTables 1.7 or greater - www.datatables.net/download");g.fn.dataTable.ColVis=f;return g.fn.DataTable.ColVis=f};"function"===typeof define&&define.amd?define(["jquery","datatables"],b):"object"===typeof exports?b(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.ColVis&&b(jQuery,jQuery.fn.dataTable)})(window,document);