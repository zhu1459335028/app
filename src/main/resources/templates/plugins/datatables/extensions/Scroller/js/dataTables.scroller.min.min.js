/*!
 Scroller 1.2.2
 Â©2011-2014 SpryMedia Ltd - datatables.net/license
*/
(function(a,d,c){var b=function(j){var h=function(g,e){!this instanceof h?alert("Scroller warning: Scroller must be initialised with the 'new' keyword."):("undefined"==typeof e&&(e={}),this.s={dt:g,tableTop:0,tableBottom:0,redrawTop:0,redrawBottom:0,autoHeight:!0,viewportRows:0,stateTO:null,drawTO:null,heights:{jump:null,page:null,virtual:null,scroll:null,row:null,viewport:null},topRowFloat:0,scrollDrawDiff:null,loaderVisible:!1},this.s=j.extend(this.s,h.oDefaults,e),this.s.heights.row=this.s.rowHeight,this.dom={force:d.createElement("div"),scroller:null,table:null,loader:null},this.s.dt.oScroller=this,this._fnConstruct())};h.prototype={fnRowToPixels:function(g,e,i){g=i?this._domain("virtualToPhysical",g*this.s.heights.row):this.s.baseScrollTop+(g-this.s.baseRowTop)*this.s.heights.row;return e||e===c?parseInt(g,10):g},fnPixelsToRow:function(g,e,k){var i=g-this.s.baseScrollTop,g=k?this._domain("physicalToVirtual",g)/this.s.heights.row:i/this.s.heights.row+this.s.baseRowTop;return e||e===c?parseInt(g,10):g},fnScrollToRow:function(g,e){var m=this,l=!1,k=this.fnRowToPixels(g),i=g-(this.s.displayBuffer-1)/2*this.s.viewportRows;0>i&&(i=0);if((k>this.s.redrawBottom||k<this.s.redrawTop)&&this.s.dt._iDisplayStart!==i){l=!0,k=this.fnRowToPixels(g,!1,!0)}"undefined"==typeof e||e?(this.s.ani=l,j(this.dom.scroller).animate({scrollTop:k},function(){setTimeout(function(){m.s.ani=!1},25)})):j(this.dom.scroller).scrollTop(k)},fnMeasure:function(g){this.s.autoHeight&&this._fnCalcRowHeight();var e=this.s.heights;e.viewport=j(this.dom.scroller).height();this.s.viewportRows=parseInt(e.viewport/e.row,10)+1;this.s.dt._iDisplayLength=this.s.viewportRows*this.s.displayBuffer;(g===c||g)&&this.s.dt.oInstance.fnDraw()},_fnConstruct:function(){var g=this;if(this.s.dt.oFeatures.bPaginate){this.dom.force.style.position="absolute";this.dom.force.style.top="0px";this.dom.force.style.left="0px";this.dom.force.style.width="1px";this.dom.scroller=j("div."+this.s.dt.oClasses.sScrollBody,this.s.dt.nTableWrapper)[0];this.dom.scroller.appendChild(this.dom.force);this.dom.scroller.style.position="relative";this.dom.table=j(">table",this.dom.scroller)[0];this.dom.table.style.position="absolute";this.dom.table.style.top="0px";this.dom.table.style.left="0px";j(this.s.dt.nTableWrapper).addClass("DTS");this.s.loadingIndicator&&(this.dom.loader=j('<div class="DTS_Loading">'+this.s.dt.oLanguage.sLoadingRecords+"</div>").css("display","none"),j(this.dom.scroller.parentNode).css("position","relative").append(this.dom.loader));this.s.heights.row&&"auto"!=this.s.heights.row&&(this.s.autoHeight=!1);this.fnMeasure(!1);this.s.ingnoreScroll=!0;this.s.stateSaveThrottle=this.s.dt.oApi._fnThrottle(function(){g.s.dt.oApi._fnSaveState(g.s.dt)},500);j(this.dom.scroller).on("scroll.DTS",function(){g._fnScroll.call(g)});j(this.dom.scroller).on("touchstart.DTS",function(){g._fnScroll.call(g)});this.s.dt.aoDrawCallback.push({fn:function(){g.s.dt.bInitialised&&g._fnDrawCallback.call(g)},sName:"Scroller"});j(a).on("resize.DTS",function(){g.fnMeasure(false);g._fnInfo()});var e=!0;this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(k,i){if(e&&g.s.dt.oLoadedState){i.iScroller=g.s.dt.oLoadedState.iScroller;i.iScrollerTopRow=g.s.dt.oLoadedState.iScrollerTopRow;e=false}else{i.iScroller=g.dom.scroller.scrollTop;i.iScrollerTopRow=g.s.topRowFloat}},"Scroller_State");this.s.dt.oLoadedState&&(this.s.topRowFloat=this.s.dt.oLoadedState.iScrollerTopRow||0);this.s.dt.aoDestroyCallback.push({sName:"Scroller",fn:function(){j(a).off("resize.DTS");j(g.dom.scroller).off("touchstart.DTS scroll.DTS");j(g.s.dt.nTableWrapper).removeClass("DTS");j("div.DTS_Loading",g.dom.scroller.parentNode).remove();g.dom.table.style.position="";g.dom.table.style.top="";g.dom.table.style.left=""}})}else{this.s.dt.oApi._fnLog(this.s.dt,0,"Pagination must be enabled for Scroller")}},_fnScroll:function(){var g=this,e=this.s.heights,l=this.dom.scroller.scrollTop,k;if(!this.s.skip&&!this.s.ingnoreScroll){if(this.s.dt.bFiltered||this.s.dt.bSorted){this.s.lastScrollTop=0}else{this._fnInfo();clearTimeout(this.s.stateTO);this.s.stateTO=setTimeout(function(){g.s.dt.oApi._fnSaveState(g.s.dt)},250);if(l<this.s.redrawTop||l>this.s.redrawBottom){var i=Math.ceil((this.s.displayBuffer-1)/2*this.s.viewportRows);Math.abs(l-this.s.lastScrollTop)>e.viewport||this.s.ani?(k=parseInt(this._domain("physicalToVirtual",l)/e.row,10)-i,this.s.topRowFloat=this._domain("physicalToVirtual",l)/e.row):(k=this.fnPixelsToRow(l)-i,this.s.topRowFloat=this.fnPixelsToRow(l,!1));0>=k?k=0:k+this.s.dt._iDisplayLength>this.s.dt.fnRecordsDisplay()?(k=this.s.dt.fnRecordsDisplay()-this.s.dt._iDisplayLength,0>k&&(k=0)):0!==k%2&&k++;if(k!=this.s.dt._iDisplayStart&&(this.s.tableTop=j(this.s.dt.nTable).offset().top,this.s.tableBottom=j(this.s.dt.nTable).height()+this.s.tableTop,e=function(){if(g.s.scrollDrawReq===null){g.s.scrollDrawReq=l}g.s.dt._iDisplayStart=k;g.s.dt.oApi._fnCalculateEnd&&g.s.dt.oApi._fnCalculateEnd(g.s.dt);g.s.dt.oApi._fnDraw(g.s.dt)},this.s.dt.oFeatures.bServerSide?(clearTimeout(this.s.drawTO),this.s.drawTO=setTimeout(e,this.s.serverWait)):e(),this.dom.loader&&!this.s.loaderVisible)){this.dom.loader.css("display","block"),this.s.loaderVisible=!0}}this.s.lastScrollTop=l;this.s.stateSaveThrottle()}}},_domain:function(i,g){var n=this.s.heights,m;if(n.virtual===n.scroll){m=(n.virtual-n.viewport)/(n.scroll-n.viewport);if("virtualToPhysical"===i){return g/m}if("physicalToVirtual"===i){return g*m}}var l=(n.scroll-n.viewport)/2,k=(n.virtual-n.viewport)/2;m=k/(l*l);if("virtualToPhysical"===i){if(g<k){return Math.pow(g/m,0.5)}g=2*k-g;return 0>g?n.scroll:2*l-Math.pow(g/m,0.5)}if("physicalToVirtual"===i){if(g<l){return g*g*m}g=2*l-g;return 0>g?n.virtual:2*k-g*g*m}},_fnDrawCallback:function(){var i=this,e=this.s.heights,p=this.dom.scroller.scrollTop,o=j(this.s.dt.nTable).height(),n=this.s.dt._iDisplayStart,l=this.s.dt._iDisplayLength,m=this.s.dt.fnRecordsDisplay();this.s.skip=!0;this._fnScrollForce();p=0===n?this.s.topRowFloat*e.row:n+l>=m?e.scroll-(m-this.s.topRowFloat)*e.row:this._domain("virtualToPhysical",this.s.topRowFloat*e.row);this.dom.scroller.scrollTop=p;this.s.baseScrollTop=p;this.s.baseRowTop=this.s.topRowFloat;var k=p-(this.s.topRowFloat-n)*e.row;0===n?k=0:n+l>=m&&(k=e.scroll-o);this.dom.table.style.top=k+"px";this.s.tableTop=k;this.s.tableBottom=o+this.s.tableTop;o=(p-this.s.tableTop)*this.s.boundaryScale;this.s.redrawTop=p-o;this.s.redrawBottom=p+o;this.s.skip=!1;this.s.dt.oFeatures.bStateSave&&null!==this.s.dt.oLoadedState&&"undefined"!=typeof this.s.dt.oLoadedState.iScroller?((p=(this.s.dt.sAjaxSource||i.s.dt.ajax)&&!this.s.dt.oFeatures.bServerSide?!0:!1)&&2==this.s.dt.iDraw||!p&&1==this.s.dt.iDraw)&&setTimeout(function(){j(i.dom.scroller).scrollTop(i.s.dt.oLoadedState.iScroller);i.s.redrawTop=i.s.dt.oLoadedState.iScroller-e.viewport/2;setTimeout(function(){i.s.ingnoreScroll=!1},0)},0):i.s.ingnoreScroll=!1;setTimeout(function(){i._fnInfo.call(i)},0);this.dom.loader&&this.s.loaderVisible&&(this.dom.loader.css("display","none"),this.s.loaderVisible=!1)},_fnScrollForce:function(){var e=this.s.heights;e.virtual=e.row*this.s.dt.fnRecordsDisplay();e.scroll=e.virtual;1000000<e.scroll&&(e.scroll=1000000);this.dom.force.style.height=e.scroll+"px"},_fnCalcRowHeight:function(){var g=this.s.dt,e=g.nTable,l=e.cloneNode(!1),k=j("<tbody/>").appendTo(l),i=j('<div class="'+g.oClasses.sWrapper+' DTS"><div class="'+g.oClasses.sScrollWrapper+'"><div class="'+g.oClasses.sScrollBody+'"></div></div></div>');for(j("tbody tr:lt(4)",e).clone().appendTo(k);3>j("tr",k).length;){k.append("<tr><td>&nbsp;</td></tr>")}j("div."+g.oClasses.sScrollBody,i).append(l);g._bInitComplete?g=e.parentNode:(this.s.dt.nHolding||(this.s.dt.nHolding=j("<div></div>").insertBefore(this.s.dt.nTable)),g=this.s.dt.nHolding);i.appendTo(g);this.s.heights.row=j("tr",k).eq(1).outerHeight();i.remove()},_fnInfo:function(){if(this.s.dt.oFeatures.bInfo){var t=this.s.dt,s=t.oLanguage,r=this.dom.scroller.scrollTop,q=Math.floor(this.fnPixelsToRow(r,!1,this.s.ani)+1),p=t.fnRecordsTotal(),n=t.fnRecordsDisplay(),r=Math.ceil(this.fnPixelsToRow(r+this.s.heights.viewport,!1,this.s.ani)),r=n<r?n:r,o=t.fnFormatNumber(q),l=t.fnFormatNumber(r),m=t.fnFormatNumber(p),e=t.fnFormatNumber(n),o=0===t.fnRecordsDisplay()&&t.fnRecordsDisplay()==t.fnRecordsTotal()?s.sInfoEmpty+s.sInfoPostFix:0===t.fnRecordsDisplay()?s.sInfoEmpty+" "+s.sInfoFiltered.replace("_MAX_",m)+s.sInfoPostFix:t.fnRecordsDisplay()==t.fnRecordsTotal()?s.sInfo.replace("_START_",o).replace("_END_",l).replace("_MAX_",m).replace("_TOTAL_",e)+s.sInfoPostFix:s.sInfo.replace("_START_",o).replace("_END_",l).replace("_MAX_",m).replace("_TOTAL_",e)+" "+s.sInfoFiltered.replace("_MAX_",t.fnFormatNumber(t.fnRecordsTotal()))+s.sInfoPostFix;(s=s.fnInfoCallback)&&(o=s.call(t.oInstance,t,q,r,p,n,o));t=t.aanFeatures.i;if("undefined"!=typeof t){q=0;for(p=t.length;q<p;q++){j(t[q]).html(o)}}}}};h.defaults={trace:!1,rowHeight:"auto",serverWait:200,displayBuffer:9,boundaryScale:0.5,loadingIndicator:!1};h.oDefaults=h.defaults;h.version="1.2.2";"function"==typeof j.fn.dataTable&&"function"==typeof j.fn.dataTableExt.fnVersionCheck&&j.fn.dataTableExt.fnVersionCheck("1.9.0")?j.fn.dataTableExt.aoFeatures.push({fnInit:function(g){var e=g.oInit;return(new h(g,e.scroller||e.oScroller||{})).dom.wrapper},cFeature:"S",sFeature:"Scroller"}):alert("Warning: Scroller requires DataTables 1.9.0 or greater - www.datatables.net/download");j.fn.dataTable.Scroller=h;j.fn.DataTable.Scroller=h;if(j.fn.dataTable.Api){var f=j.fn.dataTable.Api;f.register("scroller()",function(){return this});f.register("scroller().rowToPixels()",function(g,e,k){var i=this.context;if(i.length&&i[0].oScroller){return i[0].oScroller.fnRowToPixels(g,e,k)}});f.register("scroller().pixelsToRow()",function(g,e,k){var i=this.context;if(i.length&&i[0].oScroller){return i[0].oScroller.fnPixelsToRow(g,e,k)}});f.register("scroller().scrollToRow()",function(g,e){this.iterator("table",function(i){i.oScroller&&i.oScroller.fnScrollToRow(g,e)});return this});f.register("scroller().measure()",function(e){this.iterator("table",function(g){g.oScroller&&g.oScroller.fnMeasure(e)});return this})}return h};"function"===typeof define&&define.amd?define(["jquery","datatables"],b):"object"===typeof exports?b(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.Scroller&&b(jQuery,jQuery.fn.dataTable)})(window,document);